# 识别和定位

## 适用场景

- 一个类别，一个目标；
- 一个类别，多个固定目标；

## 基本思想

识别+用回归做定位：

- 一个类别，一个目标位置：分类+定位；
- 一个类别，一个目标的多个部分（数量固定）位置：分类+定位；

DeepPose：Toshev and Szegedy（Google）, “DeepPose: Human Pose Estimation via Deep Neural Networks”, CVPR 2014；

### 步骤

1. 先训练CNN分类器，或者下载Alex、VGG或者GoogleNet；
2. 在全连接层之前加入一个定位回归全连接块；
3. 用自己的数据集，使用L2距离作为损失度量训练这个定位回归块；
4. 进行测试，会产生两组结果，一组分类结果，一组回归定位结果；

### 回归的两种方式

- 不定类回归，class-agnostic regression，无论分类网络如何输出，不定类回归只输出一个框的4个参数即可；
- 特定类回归，class-specific regression，每个类别输出一个框的4个参数；

## 扩展：sliding window

Overfeat：Sermanet et al, “Integrated Recognition, Localization and Detection using Convolutional Networks”, ICLR 2014；

### 特点

- 利用分类+定位，通过滑窗，应用到大分辨率图片；
- 每个滑窗依然是做分类+定位操作；
- 每个滑窗处理的BBox，不一定都是在滑窗内部；
- 滑窗遍历一张图片后（多个尺度），聚合所有的滑窗结果，来确定目标的种类和位置；
- 合并所有尺度上的分类得分和位置回归，形成最终预测；
- 用卷积层替换全连接层，计算更加高效；
- 可以进行目标检测；

### 卷积层替换全连接层

- 与输入尺寸相同的卷积核，可以输出1x1xC的一维特征向量；
- 1x1的卷积核，输出原有的尺寸，这个过程中，进行了跨通道的信息整合，并增加了非线性转换，同时还可以调整输出Channel的数量（用于降维或者升维）；

### 缺点

每个滑窗都要进行识别+回归定位，计算量非常大。

### 问题

- 如何聚合每个滑窗的结果？

## 总结

如果任务中的目标具有固定数量，使用定位框架会让问题变得简单。